P1=[10 20 30 50 70 100 200 300 500 700 1000];
n=[0.78 0.81 0.83 0.85 0.87 0.88 0.92 0.93 0.94 0.945 0.95];
ntr=interp1(P1,n,219);
P2=219;
Pg=(P2/2)*(1+1/ntr);
P11=[10 20 30 50 100 200 300 500 1000];
J=[4 3.8 3.6 3.2 2.4 1.40 1.25 1 0.90];
j=interp1(P11,J,219);
Sfe=1.1*sqrt(Pg*(1+ntr)/(j*ntr));
l=sqrt(Sfe);
ls=5;
b=Sfe/ls;
bs=1.20*b;
Ntole=(b*10)/0.35;
Sfes=ls*bs;
lmed=(4*ls+2*bs)/100;
U=[18 24 24];
I=[5 2 2];
Scu2=zeros(1);
d=zeros(1);
for i=1:1:3
    Scu2(1,i)=I(1,i)/j;
    d(1,i)=sqrt(4*Scu2(1,i)/pi);
end
U1=220;
I1=Pg/U1;
Scu1=I1/j;
d1=sqrt(4*Scu1/pi);
ds=[2 1.6 1.6];
d1s=1;
e=4.44*50*1.1*(0.9*Sfes)*1e-4;
w1=U1/e;
w2=zeros(1);
for i=1:1:3
    w2(i)=U(i)/e;
end
p=0.0172;
R1=w1*p*lmed/Scu1;
R2=zeros(1);
R2star=zeros(1);
Rs=zeros(1);
for i=1:1:3
    R2(1,i)=w2(i)*p*lmed/Scu2(1,i);
    R2star(i)=R2(i)+R1*(w2(i)/w1)^2;
    Rs(1,i)=U(1,i)/I(1,i)
end
e2=zeros(1);
U2=zeros(1);
e2star=zeros(1);
w2star=zeros(1);
test=zeros(1);
for i=1:3
    e2(i)=(w2(i)/w1)*U1;
    test(i)=R2star(i)*I(i);
    U2(i)=e2(i)-R2star(i)*I(i);
    w2star(i)=w2(i)+R2star(i)*I(i)/e;
    e2star(i)=w2star(i)*e;
end
P=(1/ntr)*P2;
No=w1/U1;
No2=zeros(1);
for i=1:3
    No2(i)=w2(i)/U2(i);
end
Uinv21=sqrt(2)*e2star(1);
Uinv22=2*sqrt(2)*U(3);
Uinv21star=2.12*U(1);
Uinv22star=4.24*U(2);
Uinv23star=Uinv22star;
I_2star=zeros(1);
for i=1:3
  I_2star(i)=0.7*I(i);
  I2star(i)=1.5*0.7*I(i);
end
ID=[0.3 0.7 1 3 5 10];
rd=[4 1.8 1.2 0.4 0.24 0.12];
rd2=0.24;
rd1=0.12;
Ipbridge1=(sqrt(2)*U(i))/(R2star(1)+2*rd1);
Ipdiodes2=(sqrt(2)*U(i))/(R2star(2)+rd2);
Ipdiodes3=Ipdiodes2;
Cf1=3.758*1e-3;
Cf2=2.2*1e-3;
Cf3=2.2*1e-3;
 dt1=(R2star(1)+2*rd1)*Cf1;
 dt2=(R2star(2)+rd2)*Cf2;
 dt3=(R2star(3)+rd2)*Cf3;
 Ip1dt1=Cf1*(2*(U(1))^2)/(R2star(1)+2*rd1);
 Ip2dt2=Cf2*(2*(U(2))^2)/(R2star(2)+rd2);
 Ip3dt3=Ip2dt2;
 pi=67;
 U_barat(1)=0.9*e2star(1)-(2*0.75);
  U_barat(2)=0.9*e2star(2)-0.75;
   U_barat(3)=0.9*e2star(3)-0.75;
 p0=8;
 q=pi/p0;
Rrt(1)=R2star(1)+2*rd1;
Rrt(2)=R2star(2)+rd1;
Rrt(3)=R2star(3)+rd1;
for i=1:3
Cf1_stelat(i)=((1600*q*(Rrt(i)+Rs(i)))/(Rrt(i)*Rs(i)))*10^(-6) ;
Rr(i)=Rrt(i);
R0(i)=Rs(i);
C0(i)=Cf1_stelat(i);
wC0R0(i) = 314*C0(i)*R0(i);
kr(i)=Rr(i)/R0(i);
end
E0(1)=1.41*e2star(1)-1.5;
E0(2)=1.41*e2star(2)-0.75;
E0(3)=1.41*e2star(3)-0.75;
ku1=0.76;
ku2=0.42;
Uo_barat_stelat(1)=ku1*E0(1);
Uo_barat_stelat(2)=ku2*E0(2);
Uo_barat_stelat(3)=ku2*E0(3);
C0=8/314/R0(1);
% Partea B
Ui_barat(1)=ku1*sqrt(2)*U(1)
Ui_barat(2)=ku2*sqrt(2)*U(2)
Ui_barat(3)=Ui_barat(2)
for i=1:3
    Cfi_barat(i)=(Cf1_stelat(i)+C0)/2; %asta nu
    Ui_barat_max(i)=sqrt(2)*U(i)
    Vo_barat(i)=0.5*Ui_barat(i)
    Io_N_barat(i)=Vo_barat(i)/Rs(i)
    delta_IL(i)=0.2*Io_N_barat(i)
    delta_Vo(i)=(2/100)*Vo_barat(i)
end

