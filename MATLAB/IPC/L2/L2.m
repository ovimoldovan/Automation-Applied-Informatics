clear all; clc;
t = [0, 0.2000, 0.4000, 0.6000, 0.8000, 1.0000, 1.2000, 1.4000, 1.6000, 1.8000, 2.0000, 2.2000, 2.4000, 2.6000, 2.8000, 3.0000, 3.2000, 3.4000, 3.6000, 3.8000, 4.0000, 4.2000, 4.4000, 4.6000, 4.8000, 5.0000];
y1 = [0, 0.5652, 1.0365, 1.4294, 1.7570, 2.0302, 2.2579, 2.4478, 2.6061, 2.7381, 2.8481, 2.9399, 3.0163, 3.0801, 3.1333, 3.1776, 3.2146, 3.2454, 3.2711, 3.2926, 3.3104, 3.3253, 3.3377, 3.3481, 3.3567, 3.3639];
%a
plot(t,y1, 'g'); hold on;
yss = 3.364;
y0 = 0;
rss = 1;
r0 = 0;
K = (yss-y0)/(rss-r0);
T = 1.49;
Hs = tf(K, [T 1]);
step(Hs)

%% Ex 2
clear all;clc;
t = [0, 0.2000, 0.4000, 0.6000, 0.8000, 1.0000, 1.2000, 1.4000, 1.6000, 1.8000, 2.0000, 2.2000, 2.4000, 2.6000, 2.8000, 3.0000, 3.2000, 3.4000, 3.6000, 3.8000, 4.0000, 4.2000, 4.4000, 4.6000, 4.8000, 5.0000];
y2 = [0, 0, 0, 0.5262, 1.0291, 1.4232, 1.7320, 1.9740, 2.1636, 2.3121, 2.4285, 2.5198, 2.5912, 2.6472, 2.6911, 2.7255, 2.7525, 2.7736, 2.7901, 2.8031, 2.8132, 2.8212, 2.8274, 2.8323, 2.8361, 2.8391];
plot(t,y2,'g'); hold on;
yss = 2.832;
y0 = 0;
rss = 1;
r0 = 0;
Tm = 0.4;
K = (yss-y0)/(rss-r0);
T = 1.2; % this is much better with T=1
Hs = tf(K, [T 1], 'InputDelay', Tm);
step(Hs)

%% Ex 3
clear all;clc;
t = [0, 0.2000, 0.4000, 0.6000, 0.8000, 1.0000, 1.2000, 1.4000, 1.6000, 1.8000, 2.0000, 2.2000, 2.4000, 2.6000, 2.8000, 3.0000, 3.2000, 3.4000, 3.6000, 3.8000, 4.0000, 4.2000, 4.4000, 4.6000, 4.8000, 5.0000];
y3 = [0, 0.3196, 1.0179, 1.8455, 2.6711, 3.4310, 4.0994, 4.6710, 5.1508, 5.5485, 5.8750, 6.1413, 6.3576, 6.5326, 6.6739, 6.7876, 6.8791, 6.9527, 7.0117, 7.0590, 7.0970, 7.1274, 7.1518, 7.1714, 7.1870, 7.1996];
plot(t,y3,'g'); hold on;
yss = 7.2;
y0 = 0;
rss = 1;
r0 = 0;
Tm = 0.25;
K = (yss-y0)/(rss-r0);
T = 1;
Hs = tf(K, [T 1], 'InputDelay', Tm);
step(Hs, 'r')
%Cohen Coon
t632index = 0.632 * yss;
t28index = 0.28 * yss;
t632=1.4;
t28=0.6;
T4 = 1.5 * (t632 - t28);
Tm4 = 1.5 * (t28 - (0.33*t632));
Hs = tf(K, [T4 1], 'InputDelay', Tm4);
step(Hs, 'b')
